<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MoonTune</title>
  <style>


  </style>
</head>

<body>
  <script>
    //调号的升降
    var option1 = ["-", "升", "降"]
    //调号
    var option2 = "ABCDEFG"
    //记号的升降
    var option3 = ["升", "降"]
    //升降记号数量
    var option4 = "1234567"

    var answer_array_type1 = [[0, 6], [0, 3], [0, 0], [0, 4], [0, 1], [1, 5], [1, 2], [0, 5], [2, 1], [2, 4], [2, 0], [2, 3], [2, 6], [2, 2]]

    var right_answer1
    var right_answer2

    window.onload = function () {
      gen_question()
    };

    function gen_question() {
      var type = Math.floor(Math.random() * 2)
      var tune_no = Math.floor(Math.random() * 14)
      if (type == 0) {
        right_answer1 = answer_array_type1[tune_no][0]
        right_answer2 = answer_array_type1[tune_no][1]
      } else {
        right_answer1 = Math.floor(tune_no / 7)
        right_answer2 = tune_no % 7
      }
      console.log("right-answer:")
      console.log(right_answer1, right_answer2)

      gen_option(type)
      let question_img = document.getElementById("question-img")
      question_img.src = "./tuneImg/" + tune_no.toString() + "-" + type.toString() + ".png"
    }

    function check_answer() {
      var answer1
      var answer2
      let form_answer1 = document.getElementsByName("answer1")
      for (var i = 0, length = form_answer1.length; i < length; i++) {
        if (form_answer1[i].checked) {
          // 弹出选中值
          answer1 = form_answer1[i].value
          // 选中后退出循环
          break;
        }
      }
      let form_answer2 = document.getElementsByName("answer2")
      for (var i = 0, length = form_answer2.length; i < length; i++) {
        if (form_answer2[i].checked) {
          answer2 = form_answer2[i].value
          break;
        }
      }
      console.log(answer1, answer2)
      if (answer1 == right_answer1 & answer2 == right_answer2) {
        alert("right")
      } else {
        alert("wrong")
      }
    }

    function gen_option(type) {
      let option_form_1 = document.getElementById("option_form_1")
      let option_form_2 = document.getElementById("option_form_2")

      option_form_1.innerHTML = null
      option_form_2.innerHTML = null

      if (type == 0) { //根据图像选调号
        for (var i = 0; i < 3; i++) {
          var new_label = document.createElement("label")
          var new_input = document.createElement("input")
          new_input.type = "radio"
          new_input.name = "answer1"
          new_input.value = i
          new_label.innerText = option1[i]
          option_form_1.appendChild(new_input)
          option_form_1.appendChild(new_label)
        }

        for (var i = 0; i < 7; i++) {
          var new_label = document.createElement("label")
          var new_input = document.createElement("input")
          new_input.type = "radio"
          new_input.name = "answer2"
          new_input.value = i
          new_label.innerText = option2.charAt(i) + "大调"
          option_form_2.appendChild(new_input)
          option_form_2.appendChild(new_label)
        }
      } else { //根据调号选图像
        for (var i = 0; i < 2; i++) {
          var new_label = document.createElement("label")
          var new_input = document.createElement("input")
          new_input.type = "radio"
          new_input.name = "answer1"
          new_input.value = i
          new_label.innerText = option3[i]
          option_form_1.appendChild(new_input)
          option_form_1.appendChild(new_label)
        }

        for (var i = 0; i < 7; i++) {
          var new_label = document.createElement("label")
          var new_input = document.createElement("input")
          new_input.type = "radio"
          new_input.name = "answer2"
          new_input.value = i
          new_label.innerText = (i + 1).toString()
          option_form_2.appendChild(new_input)
          option_form_2.appendChild(new_label)
        }
      }
    }
  </script>
  <div>
    <img id="question-img" src="./tuneImg/default.png">
  </div>
  <div>
    <form id="option_form_1">
    </form>

    <form id="option_form_2">
    </form>

  </div>
  <div>
    <button onclick="check_answer()">检查</button>
    <button onclick="gen_question()">继续</button>
  </div>
</body>

</html>